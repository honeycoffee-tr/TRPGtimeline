<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TRPG 시나리오 타임라인</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/lucide.min.css" rel="stylesheet">
</head>
<body>
    <div id="app">
        <!-- 헤더 -->
        <div class="header">
            <div class="header-content">
                <div class="header-info">
                    <h1 id="scenario-title">TRPG 시나리오 타임라인</h1>
                    <p id="scenario-base-year" class="scenario-meta"></p>
                    <p id="scenario-overview" class="scenario-meta"></p>
                    <!-- GitHub 상태 표시 -->
                    <div id="github-status" class="github-status disconnected">
                        <i data-lucide="alert-circle"></i>GitHub 미연결
                    </div>
                </div>
                <div class="header-buttons">
                    <button id="scenario-btn" class="btn btn-secondary">
                        <i data-lucide="file-text"></i>시나리오
                    </button>
                    <button id="time-btn" class="btn btn-secondary">
                        <i data-lucide="clock"></i>시간 추가
                    </button>
                    <button id="event-btn" class="btn btn-primary">
                        <i data-lucide="plus"></i>사건 추가
                    </button>
                    
                    <!-- GitHub 협업 버튼들 -->
                    <div class="github-buttons">
                        <button id="github-share-btn" class="btn btn-github">
                            <i data-lucide="share-2"></i>GitHub 공유
                        </button>
                        <button id="github-load-btn" class="btn btn-github">
                            <i data-lucide="download-cloud"></i>GitHub 불러오기
                        </button>
                    </div>
                    
                    <button id="export-btn" class="btn btn-secondary">
                        <i data-lucide="download"></i>내보내기
                    </button>
                    <label class="btn btn-secondary">
                        <i data-lucide="upload"></i>가져오기
                        <input type="file" id="import-file" accept=".json" style="display: none;">
                    </label>
                </div>
            </div>
        </div>

        <!-- 타임라인 -->
        <div class="timeline-container">
            <div class="timeline-wrapper">
                <!-- 중앙 라인 -->
                <div class="timeline-line"></div>
                <!-- 타임라인 컨텐트 -->
                <div id="timeline-content"></div>
            </div>
        </div>

        <!-- 기존 모달들 -->
        <div id="scenario-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>시나리오 설정</h2>
                    <button class="modal-close" data-modal="scenario-modal">
                        <i data-lucide="x"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>시나리오 제목</label>
                        <input type="text" id="modal-scenario-title" class="form-input">
                    </div>
                    <div class="form-group">
                        <label>시나리오 개요</label>
                        <textarea id="modal-scenario-overview" class="form-textarea" placeholder="시나리오에 대한 간단한 설명을 입력하세요"></textarea>
                    </div>
                    <div class="form-group">
                        <label>기준 년도</label>
                        <input type="text" id="modal-scenario-year" class="form-input" placeholder="예: 2024, 1994, 미래 3000년">
                    </div>
                    
                    <div class="characters-section">
                        <h3>등장인물</h3>
                        <div class="character-form">
                            <div class="character-input">
                                <input type="text" id="character-name" class="form-input" placeholder="등장인물 이름">
                                <input type="color" id="character-color" class="color-input" value="#3B82F6">
                            </div>
                            <button id="add-character-btn" class="btn btn-primary">추가</button>
                        </div>
                        <div id="characters-list" class="characters-list"></div>
                    </div>
                </div>
            </div>
        </div>

        <div id="time-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="time-modal-title">시간 추가</h2>
                    <button class="modal-close" data-modal="time-modal">
                        <i data-lucide="x"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>시간 종류</label>
                        <select id="time-type" class="form-select">
                            <option value="year">년도</option>
                            <option value="month">월</option>
                            <option value="day">일</option>
                            <option value="time">시간 (AM/PM)</option>
                            <option value="etc">기타</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>부모 시간대 (선택사항)</label>
                        <select id="parent-time" class="form-select">
                            <option value="">상위 시간대 없음</option>
                        </select>
                    </div>
                    <div id="time-inputs" class="time-inputs">
                        <select id="time-ampm" class="form-select">
                            <option value="AM">AM</option>
                            <option value="PM">PM</option>
                        </select>
                        <input type="number" id="time-hour" class="form-input" min="1" max="12" placeholder="시">
                        <input type="number" id="time-minute" class="form-input" min="0" max="59" placeholder="분">
                    </div>
                    <div class="form-group">
                        <label>크기</label>
                        <select id="time-size" class="form-select">
                            <option value="small">작게</option>
                            <option value="medium">보통</option>
                            <option value="large">크게</option>
                        </select>
                    </div>
                    <div class="form-group" id="time-value-group">
                        <label>시간 값</label>
                        <input type="text" id="time-value" class="form-input" placeholder="예: 2024, 3월, 15일, 중요한 순간">
                    </div>
                    <button id="save-time-btn" class="btn btn-primary">추가</button>
                </div>
            </div>
        </div>

        <div id="event-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="event-modal-title">사건 추가</h2>
                    <button class="modal-close" data-modal="event-modal">
                        <i data-lucide="x"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>시간대 선택</label>
                        <select id="event-time" class="form-select">
                            <option value="">시간대를 선택하세요</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>사건 타입</label>
                        <select id="event-type" class="form-select">
                            <option value="main">메인 사건</option>
                            <option value="sub">서브 사건</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>등장인물</label>
                        <select id="event-character" class="form-select">
                            <option value="">선택하세요</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label id="event-title-label">사건 제목</label>
                        <input type="text" id="event-title" class="form-input">
                    </div>
                    <div class="form-group">
                        <label id="event-content-label">상세 내용</label>
                        <textarea id="event-content" class="form-textarea"></textarea>
                        <div id="event-content-count" class="char-count"></div>
                    </div>
                    <div class="form-group" id="event-position-group">
                        <label>위치</label>
                        <select id="event-position" class="form-select">
                            <option value="auto">자동 (번갈아가며)</option>
                            <option value="right">오른쪽</option>
                            <option value="left">왼쪽</option>
                        </select>
                    </div>
                    <button id="save-event-btn" class="btn btn-primary">추가</button>
                </div>
            </div>
        </div>

        <!-- GitHub 공유 모달 -->
        <div id="github-share-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>GitHub Gist로 공유</h2>
                    <button class="modal-close" data-modal="github-share-modal">
                        <i data-lucide="x"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="github-info">
                        <div class="info-box">
                            <i data-lucide="info"></i>
                            <p>GitHub Gist를 통해 팀원들과 타임라인을 공유할 수 있습니다. 생성된 링크를 팀원들에게 전달하세요.</p>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Gist 제목</label>
                        <input type="text" id="gist-title" class="form-input" placeholder="현재 시나리오 제목이 사용됩니다">
                    </div>
                    <div class="form-group">
                        <label>설명 (선택사항)</label>
                        <textarea id="gist-description" class="form-textarea" placeholder="Gist에 대한 간단한 설명을 입력하세요"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="gist-public" checked>
                            공개 Gist로 생성 (팀원들이 접근할 수 있도록 권장)
                        </label>
                    </div>
                    
                    <button id="share-to-gist-btn" class="btn btn-github">GitHub에 공유</button>
                    
                    <div id="share-result" class="share-result" style="display: none;">
                        <h4>공유 완료!</h4>
                        <div class="form-group">
                            <label>Gist 링크 (팀원들과 공유)</label>
                            <div class="url-input-group">
                                <input type="text" id="gist-url" class="form-input" readonly>
                                <button type="button" class="btn btn-secondary" onclick="app.copyToClipboard(document.getElementById('gist-url').value)">
                                    <i data-lucide="copy"></i>복사
                                </button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Raw 파일 링크</label>
                            <div class="url-input-group">
                                <input type="text" id="gist-raw-url" class="form-input" readonly>
                                <button type="button" class="btn btn-secondary" onclick="app.copyToClipboard(document.getElementById('gist-raw-url').value)">
                                    <i data-lucide="copy"></i>복사
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- GitHub 불러오기 모달 -->
        <div id="github-load-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>GitHub Gist에서 불러오기</h2>
                    <button class="modal-close" data-modal="github-load-modal">
                        <i data-lucide="x"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="github-info">
                        <div class="info-box">
                            <i data-lucide="info"></i>
                            <p>팀원이 공유한 GitHub Gist URL을 입력하여 타임라인을 불러올 수 있습니다.</p>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>GitHub Gist URL</label>
                        <input type="url" id="load-gist-url" class="form-input" placeholder="https://gist.github.com/...">
                        <small class="form-help">Gist 링크 또는 Raw 파일 링크를 입력하세요</small>
                    </div>
                    
                    <button id="load-from-gist-btn" class="btn btn-github">Gist에서 불러오기</button>
                    
                    <div class="warning-box">
                        <i data-lucide="alert-triangle"></i>
                        <p>불러오기를 실행하면 현재 작업 중인 타임라인이 교체됩니다. 필요한 경우 먼저 현재 작업을 저장해주세요.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/lucide.min.js"></script>
    <script src="script.js"></script>
    <script>
        // 전역에서 앱 인스턴스 접근 가능하도록
        let app;
        document.addEventListener('DOMContentLoaded', () => {
            app = new TRPGTimeline();
        });
    </script>
</body>
</html>
